<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Retiros</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #f4f4f4; }
        input, button { padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h2>Registro de Retiros</h2>
    <label>Monto: <input type="number" id="monto" required></label>
    <label>Fecha: <input type="date" id="fecha" required></label>
    <label>Observaciones: <input type="text" id="observaciones"></label>
    <button onclick="agregarRetiro()">Agregar Retiro</button>
    
    <table>
        <thead>
            <tr>
                <th>Monto</th>
                <th>Fecha</th>
                <th>Observaciones</th>
            </tr>
        </thead>
        <tbody id="tabla-retiros"></tbody>
    </table>
    
    <canvas id="graficoRetiros" width="400" height="200"></canvas>
    
    <script>
        let retiros = [];
        
        function agregarRetiro() {
            let monto = document.getElementById('monto').value;
            let fecha = document.getElementById('fecha').value;
            let observaciones = document.getElementById('observaciones').value;
            
            if (monto && fecha) {
                retiros.push({ monto: parseFloat(monto), fecha, observaciones });
                actualizarTabla();
                actualizarGrafico();
                document.getElementById('monto').value = '';
                document.getElementById('fecha').value = '';
                document.getElementById('observaciones').value = '';
            } else {
                alert("Por favor, completa todos los campos requeridos.");
            }
        }
        
        function actualizarTabla() {
            let tabla = document.getElementById('tabla-retiros');
            tabla.innerHTML = '';
            retiros.forEach(ret => {
                let fila = `<tr><td>${ret.monto}</td><td>${ret.fecha}</td><td>${ret.observaciones}</td></tr>`;
                tabla.innerHTML += fila;
            });
        }
        
        function actualizarGrafico() {
            let ctx = document.getElementById('graficoRetiros').getContext('2d');
            let etiquetas = retiros.map(ret => ret.fecha);
            let datos = retiros.map(ret => ret.monto);
            
            if (window.miGrafico) {
                window.miGrafico.destroy();
            }
            
            window.miGrafico = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: etiquetas,
                    datasets: [{
                        label: 'Monto de Retiros',
                        data: datos,
                        backgroundColor: 'rgba(54, 162, 235, 0.5)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
        }
    </script>
</body>
</html>
